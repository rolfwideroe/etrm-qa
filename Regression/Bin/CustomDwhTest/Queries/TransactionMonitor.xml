<DbQuery>
	<Columns>
		<Column ColumnName="ReportCurrency" ColumnDataType="System.String"/>
		<Column ColumnName="Filtername" ColumnDataType="System.String"/>
		<Column ColumnName="Date" ColumnDataType="System.DateTime"/>
		<Column ColumnName="Time" ColumnDataType="System.DateTime"/>
		<Column ColumnName="Commodity" ColumnDataType="System.String"/>
		<Column ColumnName="Unit" ColumnDataType="System.String"/>
		<Column ColumnName="Portfolio" ColumnDataType="System.String"/>
		<Column ColumnName="PortfolioID" ColumnDataType="System.Int32"/>
		<Column ColumnName="CntpPortfolio" ColumnDataType="System.String"/>
		<Column ColumnName="CntpPortfolioID" ColumnDataType="System.Int32"/>
		<Column ColumnName="Company" ColumnDataType="System.String"/>
		<Column ColumnName="CounterpartyCompany" ColumnDataType="System.String"/>
		<Column ColumnName="Profile" ColumnDataType="System.String"/>
		<Column ColumnName="Delocation" ColumnDataType="System.String"/>
		<Column ColumnName="PriceBasis" ColumnDataType="System.String"/>
		<Column ColumnName="TimeZone" ColumnDataType="System.String"/>
		<Column ColumnName="Currency" ColumnDataType="System.String"/>
		<Column ColumnName="CurrencySource" ColumnDataType="System.String"/>
		<Column ColumnName="BaseCurrency" ColumnDataType="System.String"/>
		<Column ColumnName="CrossCurrency" ColumnDataType="System.String"/>
		<Column ColumnName="ElvizUser" ColumnDataType="System.String"/>
		<Column ColumnName="Trader" ColumnDataType="System.String"/>
		<Column ColumnName="Broker" ColumnDataType="System.String"/>
		<Column ColumnName="Status" ColumnDataType="System.String"/>
		<Column ColumnName="TicketNo" ColumnDataType="System.String"/>
		<Column ColumnName="GroupField1" ColumnDataType="System.String"/>
		<Column ColumnName="GroupField2" ColumnDataType="System.String"/>
		<Column ColumnName="GroupField3" ColumnDataType="System.String"/>
		<Column ColumnName="Contractsplit" ColumnDataType="System.String"/>
		<Column ColumnName="Authid" ColumnDataType="System.Int32"/>
		<Column ColumnName="AuthConfirmed" ColumnDataType="System.Boolean"/>
		<Column ColumnName="ExternalId" ColumnDataType="System.String"/>
		<Column ColumnName="ExtSource" ColumnDataType="System.String"/>
		<Column ColumnName="BudgAcc" ColumnDataType="System.String"/>
		<Column ColumnName="Swapname" ColumnDataType="System.String"/>
		<Column ColumnName="TransPaid" ColumnDataType="System.Boolean"/>
		<Column ColumnName="BuySell" ColumnDataType="System.String"/>
		<Column ColumnName="DeclTransId" ColumnDataType="System.Int32"/>
		<Column ColumnName="BrokerFee" ColumnDataType="System.Double"/>
		<Column ColumnName="BfeeCurr" ColumnDataType="System.String"/>
		<Column ColumnName="ClearingFee" ColumnDataType="System.Double"/>
		<Column ColumnName="ClearingCurrency" ColumnDataType="System.String"/>
		<Column ColumnName="Price" ColumnDataType="System.Double"/>
		<Column ColumnName="FixingPrice" ColumnDataType="System.Double"/>
		<Column ColumnName="FromParty" ColumnDataType="System.String"/>
		<Column ColumnName="ToParty" ColumnDataType="System.String"/>
		<Column ColumnName="InArea" ColumnDataType="System.String"/>
		<Column ColumnName="OutArea" ColumnDataType="System.String"/>
		<Column ColumnName="DeliveryArea" ColumnDataType="System.String"/>
		<Column ColumnName="EntryFee" ColumnDataType="System.Double"/>
		<Column ColumnName="EntryFeeCurrency" ColumnDataType="System.String"/>
		<Column ColumnName="ExitFee" ColumnDataType="System.Double"/>
		<Column ColumnName="ExitFeeCurrency" ColumnDataType="System.String"/>
		<Column ColumnName="TransferDate" ColumnDataType="System.DateTime"/>
		<Column ColumnName="Interconnector" ColumnDataType="System.String"/>
		<Column ColumnName="SettlementRule" ColumnDataType="System.String"/>
		<Column ColumnName="CertificateTypeName" ColumnDataType="System.String"/>
		<Column ColumnName="ProductionFacilityName" ColumnDataType="System.String"/>
		<Column ColumnName="ProductionFacilityCountry" ColumnDataType="System.String"/>
		<Column ColumnName="EnergySource" ColumnDataType="System.String"/>
		<Column ColumnName="EnvironmentLabel" ColumnDataType="System.String"/>
		<Column ColumnName="FromCountry" ColumnDataType="System.String"/>
		<Column ColumnName="ToCountry" ColumnDataType="System.String"/>
		<Column ColumnName="IndexedFormula" ColumnDataType="System.String"/>
		<Column ColumnName="MasterAgreementExternalId" ColumnDataType="System.String"/>
		<Column ColumnName="MasterAgreement" ColumnDataType="System.String"/>
		<Column ColumnName="RiskValue" ColumnDataType="System.Double"/>
		<Column ColumnName="SwapPriceType" ColumnDataType="System.String"/>
		<Column ColumnName="Instrument" ColumnDataType="System.String"/>
		<Column ColumnName="InstrumentType" ColumnDataType="System.String"/>
		<Column ColumnName="DeliveryType" ColumnDataType="System.String"/>
		<Column ColumnName="LoadProfile" ColumnDataType="System.String"/>
		<Column ColumnName="FromDate" ColumnDataType="System.DateTime"/>
		<Column ColumnName="ToDate" ColumnDataType="System.DateTime"/>
		<Column ColumnName="Hours" ColumnDataType="System.Double"/>
		<Column ColumnName="ExecutionVenue" ColumnDataType="System.String"/>
		<Column ColumnName="PutCall" ColumnDataType="System.String"/>
		<Column ColumnName="Strike" ColumnDataType="System.Double"/>
		<Column ColumnName="Expiry" ColumnDataType="System.DateTime"/>		
		<Column ColumnName="ThresholdPrice" ColumnDataType="System.Double"/>
		<Column ColumnName="SamplingPeriod" ColumnDataType="System.String"/>
		<Column ColumnName="MarketPriceMultiplicator" ColumnDataType="System.Double"/>
		<Column ColumnName="Payout" ColumnDataType="System.Double"/>
		<Column ColumnName="LowerTrigger" ColumnDataType="System.Double"/>
		<Column ColumnName="UpperTrigger" ColumnDataType="System.Double"/>
		<Column ColumnName="TriggerCurrency" ColumnDataType="System.String"/>
		<Column ColumnName="ExpiryTime" ColumnDataType="System.DateTime"/>
		<Column ColumnName="Volume" ColumnDataType="System.Double"/>
		<Column ColumnName="MWh" ColumnDataType="System.Double"/>
		<Column ColumnName="OrgVolUnit" ColumnDataType="System.Int32"/>		
		<Column ColumnName="OrgPriceUnit" ColumnDataType="System.Int32"/>
		<Column ColumnName="MinVol" ColumnDataType="System.Double"/>
		<Column ColumnName="MaxVol" ColumnDataType="System.Double"/>
		<Column ColumnName="DeclVol" ColumnDataType="System.Double"/>
		<Column ColumnName="NettedVol" ColumnDataType="System.Double"/>
		<Column ColumnName="OrgPrice" ColumnDataType="System.Double"/>
		<Column ColumnName="OrgVolume" ColumnDataType="System.Double"/>
		<Column ColumnName="MarketPrice" ColumnDataType="System.Double"/>
		<Column ColumnName="RemainingHours" ColumnDataType="System.Double"/>
		<Column ColumnName="MtMValue" ColumnDataType="System.Double"/>
		<Column ColumnName="UnrealizedPL" ColumnDataType="System.Double"/>		
		<Column ColumnName="PriceSource" ColumnDataType="System.String"/>
		<Column ColumnName="CreatedBy" ColumnDataType="System.String"/>
		<Column ColumnName="BalanceArea" ColumnDataType="System.String"/>
		<Column ColumnName="Periodicity" ColumnDataType="System.String"/>
		<Column ColumnName="LookbackFrom" ColumnDataType="System.DateTime"/>
		<Column ColumnName="LookbackTo" ColumnDataType="System.DateTime"/>
		<Column ColumnName="SamplingFrom" ColumnDataType="System.DateTime"/>
		<Column ColumnName="SamplingTo" ColumnDataType="System.DateTime"/>
		<Column ColumnName="TotalQuantityUnit" ColumnDataType="System.String"/>
		<Column ColumnName="PriceUnit" ColumnDataType="System.String"/>
		<Column ColumnName="TradingFixedFee" ColumnDataType="System.Double"/>		
		<Column ColumnName="BrokerFixedFee" ColumnDataType="System.Double"/>
		<Column ColumnName="ClearingFeeFixed" ColumnDataType="System.Double"/>
		<Column ColumnName="CommissionFixedFee" ColumnDataType="System.Double"/>
		<Column ColumnName="EntryFixedFee" ColumnDataType="System.Double"/>
		<Column ColumnName="ExitFixedFee" ColumnDataType="System.Double"/>
	</Columns>
	<SqlQuery>
		DECLARE @workspace VARCHAR(255)
		DECLARE @monitor VARCHAR(255)
		DECLARE @reportDate DATE

		SET @workspace='{workspace}'
		SET @monitor='{monitor}'
		SET @reportDate='{reportdate}'

		SELECT 
		  [ReportCurr] AS ReportCurrency
		  ,[Filtername]
		  ,[Date]
		  ,[Time]
		  ,[Commodity]
		  ,[Unit]
		  ,[Portfolio]
		  ,[PortfolioID]
		  ,[CntpPortfolio]
		  ,[CntpPortfolioID]
		  ,[Company]
		  ,[CntpCompany] AS CounterpartyCompany
		  ,[Profile]
		  ,[Delocation]
		  ,[PriceBasis]
		  ,[TimeZone]
		  ,[Currency]
		  ,[CurrSource] AS CurrencySource
		  ,[BaseCurr] AS BaseCurrency
		  ,[CrossCurr] AS CrossCurrency
		  ,[User] AS ElvizUser
		  ,[Trader]
		  ,[Broker]
		  ,[Status]
		  ,[TicketNo]
		  ,[GroupField1]
		  ,[GroupField2]
		  ,[GroupField3]
		  ,[Contractsplit]
		  ,[Authid] 
		  ,[AuthConfirmed]
		  ,[ExternalId]
		  ,[ExtSource]
		  ,[BudgAcc]
		  ,[Swapname]
		  ,[TransPaid]
		  ,[BuySell]
		  ,[DeclTransId]
		  ,[BrokerFee]
		  ,[BfeeCurr]
		  ,[ClrFee] as ClearingFee
		  ,[ClrFeeCurr] as ClearingCurrency
		  ,[Price]
		  ,[FixingPrice]
		  ,[FromParty]
		  ,[ToParty]
		  ,[InArea]
		  ,[OutArea]
		  ,[DeliveryArea]
		  ,[EntryFee]
		  ,[EntryFeeCurrency]
		  ,[ExitFee]
		  ,[ExitFeeCurrency]
		  ,[TransferDate]
		  ,[Interconnector]
		  ,[SettlementRule]
		  ,[CertificateTypeName]
		  ,[ProductionFacilityName]
		  ,[ProductionFacilityCountry]
		  ,[EnergySource]
		  ,[EnvironmentLabel]
		  ,[FromCountry]
		  ,[ToCountry]
		  ,[IndexedFormula]
		  ,[MasterAgreementExternalId]
		  ,[MasterAgreement]
		  ,[RiskValue]
		  ,[SwapPriceType]
		  ,[Instrument]
		  ,[InstrumentType]
		  ,[DeliveryType]
		  ,[LoadProfile]
		  ,[From] AS FromDate
		  ,[To] AS ToDate
		  ,[Hours]
		  ,[ExecutionVenue]
		  ,[PutCall]
		  ,[Strike]
		  ,[Expiry]
		  ,[ThresholdPrice]
		  ,[SamplingPeriod]
		  ,[MarketPriceMultiplicator]
		  ,[Payout]
		  ,[LowerTrigger]
		  ,[UpperTrigger]
		  ,[TriggerCurrency]
		  ,[ExpiryTime]
		  ,[Volume]
		  ,[MWh]
		  ,[OrgVolUnit]
		  ,[OrgPriceUnit]
		  ,[MinVol]
		  ,[MaxVol]
		  ,[DeclVol]
		  ,[NettedVol]
		  ,[OrgPrice]
		  ,[OrgVolume]
		  ,[MktPrice] AS MarketPrice
		  ,[RemHours] AS RemainingHours
		  ,[MtMValue]
		  ,[UnReal_PL] AS UnrealizedPL
		  ,[PriceSource]
		  ,[CrBy] AS CreatedBy
		  ,[BalanceArea]
		  ,[Periodicity]
		  ,[LookbackFrom]
		  ,[LookbackTo]
		  ,[SamplingFrom]
		  ,[SamplingTo]
		  ,[TotalQuantityUnit]
		  ,[PriceUnit]
		  ,TradingFixedFee 
		  ,BrokerFixedFee 
		  ,ClrFixedFee as ClearingFeeFixed
		  ,CommissionFixedFee
		  ,EntryFixedFee 
		  ,ExitFixedFee 
		FROM [VizTransMonData] 
		WHERE ReportID=
					(
						SELECT [ReportID] FROM [VizTransMonReports]
						WHERE
						[Workspace]=@workspace
						AND
						[MonitorTitle]=@monitor
						AND
						[ReportDate]=@reportDate
					)
		ORDER BY [ExternalId]
	</SqlQuery>
</DbQuery>