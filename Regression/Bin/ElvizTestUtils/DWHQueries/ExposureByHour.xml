<DbQuery>
	<Columns>
		<Column ColumnName="ExposurePricebasis" ColumnDataType="System.String"/>
		<Column ColumnName="QuantityUnit" ColumnDataType="System.String"/>
		<Column ColumnName="FromTime" ColumnDataType="System.DateTime"/>
		<Column ColumnName="UntilTime" ColumnDataType="System.DateTime"/>
		<Column ColumnName="BaseExposure" ColumnDataType="System.Double"/>
		<Column ColumnName="PeakExposure" ColumnDataType="System.Double"/>
		<Column ColumnName="OffPeakExposure" ColumnDataType="System.Double"/>
	</Columns>
	<SqlQuery>
		DECLARE @workspace varchar(255)
		DECLARE @monitor varchar(255)
		DECLARE @reportDate varchar(255)

		set @workspace='{workspace}'
		set @monitor='{monitor}'
		set @reportDate='{reportdate}'

		SELECT  
			  [ExposurePricebasis]
			  ,[QuantityUnit]
			  ,[FromTime]
			  ,[UntilTime]
			  ,SUM([Exposure]) AS BaseExposure
			  ,SUM([PeakExposure]) AS PeakExposure
			  ,SUM([OffPeakExposure]) AS OffPeakExposure
		  FROM [VizExposureData]
		  WHERE [ReportId]=(
								SELECT [ReportId] FROM [VizExposureReports] 
								WHERE [Workspace]=@workspace
								AND [MonitorTitle]=@monitor
								AND [ReportDate]=@reportDate
							)
		  GROUP BY [ExposurePricebasis],[FromTime],[UntilTime],[QuantityUnit]
		  ORDER BY [ExposurePricebasis],[FromTime],[UntilTime],[QuantityUnit]
	</SqlQuery>
</DbQuery>